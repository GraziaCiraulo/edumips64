<project name="edumips64" default="jar" basedir=".">
	<target name="init">
		<property name="sourceDir" value="." />
        <property name="helpClassesDir" value="./libs" />
		<property name="version" value="1.0alpha" />
		<property name="outputDir" value="edumips" />
		<property name="jarFile" value="edumips64-${version}.jar" />
		<property name="tarbz2File" value="edumips64-${version}.tar.bz2" />
		<property name="svnJarFile" value="edumips64-svn.jar" />
	</target>

	<target name="docs" depends="init">
		<mkdir dir="${outputDir}/docs" />
		<javadoc destdir="${outputDir}/docs" 
				 author="true"
				 version="true"
				 use="true"
				 sourcepath="."
				 classpath="${sourceDir}/.."
				 packagenames="edumips64.*"/>
	</target>

	<target name="clean">
		<delete file="${jarFile}" />
	</target>

    <target name="dirs" depends="init">
		<mkdir dir="${outputDir}" />
        <javac target="5" srcdir="${sourceDir}" classpath="${helpClassesDir}" destdir="${outputDir}" nowarn="yes" debug="on" debuglevel="lines,vars,source"/>
		<mkdir dir="${outputDir}/edumips64/img" />
		<mkdir dir="${outputDir}/edumips64/data" />
		<mkdir dir="${outputDir}/edumips64/utils" />
		<mkdir dir="${outputDir}/edumips64/help_en" />
		<mkdir dir="${outputDir}/edumips64/help_it" />
		<mkdir dir="${outputDir}/com" />
		<mkdir dir="${outputDir}/javax" />

		<copy todir="${outputDir}/edumips64/img">
			<fileset dir="img">
				<include name="**/*.png" />
			</fileset>
		</copy>
		<copy todir="${outputDir}/edumips64/data">
			<fileset dir="data">
				<include name="**/*.txt" />
			</fileset>
		</copy>
		<copy todir="${outputDir}/edumips64/utils">
			<fileset dir="utils">
				<include name="**/*.properties" />
			</fileset>
		</copy>
		<copy todir="${outputDir}/edumips64/help_en">
			<fileset dir="help_en">
				<include name="**/*.*" />
			</fileset>
		</copy>
		<copy todir="${outputDir}/edumips64/help_it">
			<fileset dir="help_it">
				<include name="**/*.*" />
			</fileset>
		</copy>
        <copy todir="${outputDir}/com">
            <fileset dir="libs/com">
                <include name="**/*.class" />
            </fileset>
        </copy>
        <copy todir="${outputDir}/javax">
            <fileset dir="libs/javax">
                <include name="**/*.class" />
            </fileset>
        </copy>
    </target>


	<target name="jar" depends="init, dirs">
		<jar destfile="${jarFile}" basedir="edumips">
			<manifest>
				<attribute name="Main-Class" value="edumips64.Main"/>
			</manifest>
		</jar>
		<signjar jar="${jarFile}" keystore="key-edumips" storepass="123456" keypass="123456" alias="edumips64" />
        <delete dir="${outputDir}" /> 
	</target>

	<target name="svnjar" depends="init, dirs">
		<jar destfile="${svnJarFile}" basedir="edumips">
			<manifest>
				<attribute name="Main-Class" value="edumips64.Main"/>
			</manifest>
		</jar>
		<signjar jar="${svnJarFile}" keystore="key-edumips" storepass="123456" keypass="123456" alias="edumips64" />
        <delete dir="${outputDir}" /> 
	</target>

    <target name="release" depends="init">
        <mkdir dir="edumips64" />
		<copy todir="edumips64/">
			<fileset dir=".">
				<include name="**/*" />
			</fileset>
		</copy>

        <tar destfile="${tarbz2File}" basedir="." includes="edumips64/" compression="bzip2" />
        <delete dir="edumips64" /> 
    </target> 
</project>
